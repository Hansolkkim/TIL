* JK강의 - [View Controller Container](https://www.youtube.com/watch?v=Y6buYcI4-RQ)

# View Controller Containers

> Parent ViewController는 Child ViewController를 contain한다.

<img src="https://user-images.githubusercontent.com/92504186/154409044-f358d771-693a-4b36-8265-1e829e5a9eb2.jpg" alt="SS 2022-02-17 PM 02 04 35" width="70%;" />

## 컨테이너를 만들 때 고려해야 할 사항들

* 컨테이너(부모)의 역할은 무엇이고, 자식들의 역할은 무엇인가?
* 동시에 얼마나 많은 자식들이 보이나?
* 형제 계층에 있는 뷰컨트롤러들 관계는 무엇인가?
* 컨테이너에서 자식 뷰컨트롤러를 어떻게 추가하고 삭제하나?
* 자식 화면의 위치나 크기가 변할 수 있나? 변화가 생기는 조건은 무엇인가?
* 컨테이너가 직접 꾸미거나 내비게이션을 위해 제공하는 뷰가 있나?
* 컨테이너와 자식 사이에 어떤 통신이 필요한가? UIViewController 클래스에 선언된 표준 이벤트가 아니라 세부적으로 다른 이벤트가 필요한가?
* 컨테이너만 별도 다른 방법으로 표시해야 한다면 어떻게 해야하나?



## View Controller 기초 용어

### root View Controller와 Master/Detail ViewController

<img src="https://user-images.githubusercontent.com/92504186/154410429-ac89f139-5c96-4c59-8433-857de1e00d79.jpg" alt="SS 2022-02-17 PM 02 17 46" width="70%;" />

<img src="https://user-images.githubusercontent.com/92504186/154410886-9fd782c7-d96e-4745-af3d-e7c3ce42b472.jpg" alt="SS 2022-02-17 PM 02 22 39" width="70%;" />

### Split View Controller

<img src="https://user-images.githubusercontent.com/92504186/154411043-16172b4a-d9fa-4827-9ddd-ab434dda647f.jpg" alt="SS 2022-02-17 PM 02 24 18" width="70%;" />

## View Controller Containers

### 컨트롤러 계층 관련 API

* 하위 컨트롤러 추가/삭제

	```swift
	addChild(_:) // children 배열에 추가
	removeFromParent()
	```

* 하위 컨트롤러 접근

	```swift
	var children: [UIViewController]
	```

* 하위 콜백

	```swift
	willMove(toParent:)
	didMove(toParent:)
	```

### VC 계층과 View 계층 추가할 때 해야하는 과정

1. 부모 컨트롤러에서 `addChild(_:)` 호출
2. 자식 컨트롤러 root view를 컨테이너에 추가
3. 자식 view에 대해 레이아웃, 크기, 제약 변경
4. 자식 컨트롤러에서 `didMove(toParent:)` 호출 (이제 Parent로 다 변환이 됐다고 알려줌)

이 과정들을 진행해야 제대로 화면 크기가 변화가 생기고, 레이아웃도 조정되고, 컨테이너의 autolayout 제약이 적용됨

```swift
func displayContent(controller: UIViewControlelr) {
    self.addChild(controller)
    self.view.addSubview(controller.view)
    controller.view.frame = self.frameForContent()
    controller.didMove(toParent: self)
}

/* private func frameForContent() -> CGRect {
	return self.view.bounds
}*/
```

### VC 계층과 View 계층 제거할 때 해야하는 과정

1. 자식 컨트롤러에서 `willMove(toParent:)` 호출
2. 자식 view에 대한 제약 제거 (view를 먼저 제거하고)
3. 자식 컨트롤러 root view를 컨테이너에서 제거 (controller를 제거하도록 하는 순서)
4. 자식 컨트롤러에서 `removeFromParent()` 호출

```swift
func hideContent(controller: UIViewController) {
    controller.willMove(toParent: nil)
    controller.view.removeFromSuperview()
    controller.removeFromParent()
}
```

### 자식 컨트롤러 사이 전환

```swift
self.addChildViewController(note)
self.transition(from: recipe,
               to: note,
               duration: 3,
               options: .transitionFlipFromRight,
               animation: nil) { (finished) in
                   note.didMove(toParentViewController: self)
}
```

> ### Appearance 관련 콜백
>
> `viewWillAppear` : 
>
> 	- 윈도우의 뷰 계층에 새로운 뷰를 추가하기 직전
> 	- (필요하면) `vc.view.layoutSubviews()` 호출하기 직전
>
> `viewDidAppear` :
>
> - 윈도우의 뷰 계층에 새로운 뷰를 추가한 직후
> - (필요하면) `vc.view.layoutSubviews()` 호출한 직후
>
> `viewWillDispappear` :
>
> - 윈도우의 뷰 계층에서 특정 뷰를 제거하기 직전
>
> `viewDidDisappear` :
>
> - 윈도우의 뷰 계층에 특정 뷰를 제거한 직후

<img src="https://user-images.githubusercontent.com/92504186/154412614-ee869c73-0458-4bc5-b07b-8ea4874062c7.jpg" alt="SS 2022-02-17 PM 02 40 32" width="70%;" />

(노란색 ViewController에서 초록색 ViewController를 모달로 보여주려는 상황)

### View Controller Container 요약 정리

* 뷰 계층 구조와 동일하게 **뷰 컨트롤러 사이에도 계층 구조가 생긴다.**
* 다른 뷰컨트롤러.뷰를 추가할 때는 컨테이너를 고려해야 한다.
* 시스템 뷰컨트롤러 중에는 컨테이너가 제공되는 뷰컨트롤러도 있다.
	* Navigation Controller, TabBar Controller, Split ViewController, Page ViewController
* 일반 뷰컨트롤러도 child 뷰컨트롤러를 배열로 관리할 수 있다.
* child 뷰컨트롤러가 추가되거나 삭제될 때 추가적인 코드가 필요하다.